<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dbsun.mapper.AppTiWenMapper">
<sql id="Base_Column_List">
su.id id,
su.u_id u_id,
su.tw_name tw_name,
su.tw_time tw_time,
su.tw_note tw_note
</sql>
<!--在数据不存在的情况下进行添加-->
<insert id="addAppTiWen" parameterType="pd">
insert into app_ti_wen (
u_id,
tw_name,
tw_time,
tw_note
 ) values (
#{u_id},
#{tw_name},
now(),
#{tw_note}
) </insert>
<!--根据id删除数据-->
<delete id="deleteAppTiWenId" parameterType="pd"  >
DELETE FROM  app_ti_wen WHERE id = #{id};
</delete>
<!--根据id更新数据-->
<update id="updateAppTiWen" parameterType="pd"  >
UPDATE app_ti_wen  <set>

<if test="u_id != null and u_id !=''"> u_id = #{u_id}, </if>
<if test="tw_name != null and tw_name !=''"> tw_name = #{tw_name}, </if>
<if test="tw_time != null and tw_time !=''"> tw_time = #{tw_time}, </if>
<if test="tw_note != null and tw_note !=''"> tw_note = #{tw_note}, </if>
</set>
 WHERE id = #{id}; </update>
<!--获取数据 不分页-->
<select id="queryAppTiWenKey" parameterType="pd" resultType="pd" useCache="false">
 SELECT <include refid="Base_Column_List"/>, au.nickname as user_name FROM app_ti_wen su
 left join app_user as au on su.u_id = au.id
 where 1 = 1
 <if test="id != null and id != '' "> and su.id = #{id}  </if>
 <if test="u_id != null and u_id != '' "> and su.u_id = #{u_id}  </if>
 <if test="tw_name != null and tw_name != '' "> and su.tw_name = #{tw_name}  </if>
 <if test="tw_time != null and tw_time != '' "> and su.tw_time = #{tw_time}  </if>
 <if test="tw_note != null and tw_note != '' "> and su.tw_note = #{tw_note}  </if> order by su.tw_time desc
</select>
<!--获取用户列表数据 分页-->
<select id="queryPageAppTiWenKeyList" parameterType="page" resultType="pd" useCache="false">
 SELECT <include refid="Base_Column_List"/>, au.nickname as user_name FROM app_ti_wen su
 left join app_user as au on su.u_id = au.id
 where 1 = 1
 <if test="pd.id != null and pd.id !=''"> and su.id = #{pd.id}  </if>
 <if test="pd.u_id != null and pd.u_id !=''"> and su.u_id = #{pd.u_id}  </if>
 <if test="pd.tw_name != null and pd.tw_name !=''"> and su.tw_name = #{pd.tw_name}  </if>
 <if test="pd.tw_time != null and pd.tw_time !=''"> and su.tw_time = #{pd.tw_time}  </if>
 <if test="pd.tw_note != null and pd.tw_note !=''"> and su.tw_note = #{pd.tw_note}  </if> order by su.tw_time desc
</select>
</mapper>
